<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.12/angular.min.js"></script>
    <script data-require="ng-table@*" data-semver="0.3.1"
            src="http://bazalt-cms.com/assets/ng-table/0.3.1/ng-table.js"></script>

    <link data-require="ng-table@*" data-semver="0.3.1" rel="stylesheet"
          href="http://bazalt-cms.com/assets/ng-table/0.3.1/ng-table.css"/>
    <link data-require="bootstrap-css@*" data-semver="3.0.0" rel="stylesheet"
          href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css"/>

</head>
<body ng-app="main" ng-controller="DemoCtrl">

<div>
    <div>
        <h1>Policy Rule</h1>
    </div>
    <table ng-table="tableParams" class="table">
        <tr ng-repeat="user in $data">
            <td data-title="'target'" sortable="'target'">
                {{user.target}}
            </td>
            <td data-title="'flow'" sortable="'flow'">
                {{user.flow==''?'無限制':user.flow}}
            </td>
            <td data-title="'session'" sortable="'session'">
                {{user.session==''?'無限制':user.session}}
            </td>
            <td data-title="'application'" sortable="'application'">
                {{user.application==''?'無限制':user.application}}
            </td>

            <td data-title="'violate'" sortable="'violate'">
                {{user.violate==''?'無限制':user.violate}}
            </td>
            <td data-title="'thread'" sortable="'thread'">
                {{user.thread==''?'無限制':user.thread}}
            </td>
            <td data-title="'beginTime'" sortable="'beginTime'">
                {{user.beginTime}}
            </td>
            <td data-title="'timeCycle'" sortable="'timeCycle'">
                {{user.timeCycle}}
            </td>
            <td data-title="'enable'" sortable="'enable'">
                {{user.enable=='true'?'yes':'no'}}
            </td>

            <td data-title="'reason'" sortable="'reason'">
                {{user.reason==''?user.reason:'無說明'}}
            </td>
            <td data-title="'action'" sortable="'action'">
                {{user.action==''?user.action:'無動作'}}
            </td>

        </tr>
    </table>

</div>
<script>
    var app = angular.module('main', ['ngTable']).
                    controller('DemoCtrl', function ($scope, $filter, ngTableParams, $http) {
                        var host = '/';
                        $http({
                            method: 'post',
                            url: host + 'getpolicyrule',
                            data: {},
                            withCredentials: true
                        }).success(function (d) {
                                    data = d;

                                    $scope.tableParams = new ngTableParams({
                                        page: 1,            // show first page
                                        count: 10,          // count per page
                                        sorting: {
                                            name: 'asc'     // initial sorting
                                        }
                                    }, {
                                        total: data.length, // length of data
                                        getData: function ($defer, params) {
                                            // use build-in angular filter
                                            var orderedData = params.sorting() ?
                                                    $filter('orderBy')(data, params.orderBy()) :
                                                    data;

                                            $defer.resolve(orderedData.slice((params.page() - 1) * params.count(), params.page() * params.count()));
                                        }
                                    });
                                }).
                                error(function (data, status, headers, config) {
                                    alert(data);
                                });

                        var data = {};

                    })
            ;

</script>
</body>

</html>